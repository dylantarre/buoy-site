---
import DocsLayout from '../../../layouts/DocsLayout.astro'
---

<DocsLayout title="buoy audit" description="Generate a design system health report">
  <h1>buoy audit</h1>

  <p>
    Generate a comprehensive health report for your design system. Shows unique values found,
    compares against expected counts, identifies worst offender files, and calculates an overall score.
  </p>

  <h2>Usage</h2>

  <pre><code>buoy audit [options]</code></pre>

  <h2>Options</h2>

  <table>
    <thead>
      <tr>
        <th>Option</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>--json</code></td>
        <td>Output as JSON for scripting</td>
      </tr>
      <tr>
        <td><code>--tokens &lt;path&gt;</code></td>
        <td>Path to design tokens file for typo detection</td>
      </tr>
    </tbody>
  </table>

  <h2>Example Output</h2>

  <pre><code>$ buoy audit

Design System Health Report
───────────────────────────

Overall Score: 34/100 (Poor)

Colors
  Found: 47 unique values
  Expected: ~12
  Drift: +35 extra colors
  Most common:
    #3b82f6  (23 usages)
    #ef4444  (15 usages)
    #10b981  (12 usages)

Spacing
  Found: 31 unique values
  Expected: ~8
  Drift: +23 extra values
  Most common:
    16px  (45 usages)
    8px   (38 usages)
    24px  (22 usages)

Possible Typos
  ⚠ #3b83f6 → close to #3b82f6
  ⚠ #ef4445 → close to #ef4444

Worst Offenders
   47 issues  src/pages/Dashboard.tsx
   38 issues  src/components/Card.tsx
   29 issues  src/components/Table.tsx

──────────────────────────────────────────────────
Total unique values: 89
Total usages: 234
Files affected: 23</code></pre>

  <h2>Health Score</h2>

  <p>The score (0-100) is calculated based on:</p>

  <ul>
    <li><strong>Unique value count</strong> — Penalty for exceeding expected counts</li>
    <li><strong>Close matches</strong> — Penalty for likely typos</li>
    <li><strong>File concentration</strong> — Penalty for files with many issues</li>
  </ul>

  <table>
    <thead>
      <tr>
        <th>Score</th>
        <th>Rating</th>
        <th>Meaning</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>80-100</td>
        <td>Good</td>
        <td>Design system is well adopted</td>
      </tr>
      <tr>
        <td>50-79</td>
        <td>Fair</td>
        <td>Some drift, worth addressing</td>
      </tr>
      <tr>
        <td>30-49</td>
        <td>Needs Work</td>
        <td>Significant drift detected</td>
      </tr>
      <tr>
        <td>0-29</td>
        <td>Poor</td>
        <td>Major drift, prioritize fixes</td>
      </tr>
    </tbody>
  </table>

  <h2>Typo Detection</h2>

  <p>
    With <code>--tokens</code>, Buoy finds values that are "close" to your design tokens:
  </p>

  <pre><code>buoy audit --tokens design-tokens.json</code></pre>

  <p>
    This catches common mistakes like <code>#3b83f6</code> (typo) vs <code>#3b82f6</code> (correct token).
  </p>

  <h2>JSON Output</h2>

  <pre><code>buoy audit --json</code></pre>

  <pre><code set:text={`{
  "score": 34,
  "categories": {
    "color": {
      "uniqueCount": 47,
      "totalUsages": 156,
      "mostCommon": [
        { "value": "#3b82f6", "count": 23 }
      ]
    }
  },
  "worstFiles": [
    { "file": "src/pages/Dashboard.tsx", "issueCount": 47 }
  ],
  "totals": {
    "uniqueValues": 89,
    "totalUsages": 234,
    "filesAffected": 23
  }
}`} /></pre>

  <h2>Related Commands</h2>

  <ul>
    <li><a href="/docs/cli/drift">buoy drift</a> — Detailed drift signals with locations</li>
    <li><a href="/docs/cli/compare">buoy compare</a> — Compare against design token file</li>
    <li><a href="/docs/cli/ci">buoy ci</a> — CI-optimized output</li>
  </ul>
</DocsLayout>
